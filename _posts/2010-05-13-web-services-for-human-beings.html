---
layout: post
title: Web Services for human beings
date: '2010-05-13T15:37:00.007+02:00'
author: Fabrizio Montesi
tags:
- qtjolie
- metaservice
- jolie
- kde
modified_time: '2010-05-13T17:11:33.814+02:00'
blogger_id: tag:blogger.com,1999:blog-3856624862131672592.post-3516553896248306539
blogger_orig_url: http://fmontesi.blogspot.com/2010/05/web-services-for-human-beings.html
---

<span style="font-size: xx-small;"><i>No, this is not related to *buntu. But this is looong... and now I've got your attention. :-)</i></span><br /><span style="font-size: xx-small;"><i><br /></i></span><br />Interacting with Web Services usually implies reading some <a href="http://www.w3.org/TR/wsdl">WSDL (Web Service Description Language) document</a>. Unfortunately, WSDL documents are written in XML and can be pretty complicated, leaving the user with no other choice than to use some graphical development tool in order to understand them.<br /><br />Lately at italianaSoftware we had to handle a lot of Web Services stuff, equipped with long WSDL documents and complex data types. <a href="http://www.jolie-lang.org/">Jolie</a> already had support for the SOAP protocol, but one had to code the interface and data types of the Web Service to invoke by hand. So we started a new project aiming to enable Jolie for the automatic usage of WSDL documents, mainly composed by two parts: a tool and an improvement to the Jolie SOAP protocol. Of course both things are open source and available in the trunk branch in the Jolie svn repository!<br /><br /><b>wsdl2jolie </b>(whose executable is now installed by default if you install Jolie from trunk) is the newly developed tool in question. It simply takes a URL to a WSDL document and automatically downloads all the related files (e.g., referred XML schemas), parses them and outputs the corresponding Jolie port/interface/data type definitions.<br />Let us see an example. See this WSDL document for a service that calculates prime numbers: <a href="http://www50.brinkster.com/vbfacileinpt/np.asmx?wsdl">http://www50.brinkster.com/vbfacileinpt/np.asmx?wsdl</a>. Reading the raw XML is not so easy, or at least requires some time.<br />Let us see what we get if we execute <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">wsdl2jolie http://www50.brinkster.com/vbfacileinpt/np.asmx?wsdl</span> <span style="font-family: inherit;">:</span><br /><br /><pre>Retrieving document at 'http://www50.brinkster.com/vbfacileinpt/np.asmx?wsdl'.<br />type GetPrimeNumbersResponse:void {<br />        .GetPrimeNumbersResult?:string<br />}<br /><br />type GetPrimeNumbers:void {<br />        .max:int<br />}<br /><br />interface PrimeNumbersHttpPost {<br />RequestResponse:<br />        GetPrimeNumbers(string)(string)<br />}<br /><br />interface PrimeNumbersHttpGet {<br />RequestResponse:<br />        GetPrimeNumbers(string)(string)<br />}<br /><br />interface PrimeNumbersSoap {<br />RequestResponse:<br />        GetPrimeNumbers(GetPrimeNumbers)(GetPrimeNumbersResponse)<br />}<br /><br />outputPort PrimeNumbersHttpPost {<br />Location: "socket://www50.brinkster.com:80/vbfacileinpt/np.asmx"<br />Protocol: http<br />Interfaces: PrimeNumbersHttpPost<br />}<br /><br />outputPort PrimeNumbersHttpGet {<br />Location: "socket://www50.brinkster.com:80/vbfacileinpt/np.asmx"<br />Protocol: http<br />Interfaces: PrimeNumbersHttpGet<br />}<br /><br />outputPort PrimeNumbersSoap {<br />Location: "socket://www50.brinkster.com:80/vbfacileinpt/np.asmx"<br />Protocol: soap {<br />        .wsdl = "http://www50.brinkster.com/vbfacileinpt/np.asmx?wsdl";<br />        .wsdl.port = "PrimeNumbersSoap"<br />}<br />Interfaces: PrimeNumbersSoap<br />}<br /></pre><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-family: Arial,Helvetica,sans-serif;">which is the Jolie equivalent of the WSDL document. Those ".wsdl" and ".wsdl.port" parameters are the aforementioned improvement to the SOAP protocol: when the output port is used for the first time, Jolie will read the WSDL document for processing information about the correct configuration for interacting with the service instead of forcing the user to insert it by hand.</span></span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-family: Arial,Helvetica,sans-serif;">Now we can just put this into a file, say "PrimeNumbers.iol"<span style="font-family: inherit;">, and use the output ports we discovered from Jolie code. As in the following:</span></span></span><br /><br /><pre>include "PrimeNumbers.iol"<br />include "console.iol"<br /><br />main<br />{<br />        request.max = 27;<br />        GetPrimeNumbers@PrimeNumbersSoap( request )( response );<br />        println@Console( response.GetPrimeNumbersResult )()<br />}<br /></pre><br /><div style="font-family: inherit;"><span style="font-size: small;">That little program will output "1,3,5,7,11,13,17,19,23</span><span style="font-size: small;">"</span><span style="font-size: small;">. The example can be downloaded from <a href="http://www.jolie-lang.org/examples/unsorted/prime_numbers_wsdl.zip">this link</a> (remember, it requires Jolie from trunk).</span></div><div style="font-family: inherit;"><span style="font-size: small;"><br /></span></div><div style="font-family: inherit;"><span style="font-size: small;">wsdl2jolie acts as a nice tool for being able to use the typed interface of a Web Service from Jolie and for getting a more human-readable form of a WSDL document (its Jolie form).</span></div><div style="font-family: inherit;"><br /></div><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-family: inherit;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-family: inherit;">Another nice feature we get for free from the SOAP protocol improvement is that <b>now MetaService can act as a transparent bridge towards Web Services</b>. Simply call the addRedirection operation with the right protocol configuration (in this case, the ".wsdl" and ".wsdl.port" parameters) and MetaService will automatically download the WSDL document (we also have a cache system for them already in trunk!) and make it callable by clients.</span></span></span></span></span></span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-family: inherit;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-family: inherit;">This is a huge step forward for client libraries such as QtJolie: just tell where the WSDL document is and you can already place calls to the Web Service of interest.</span></span></span></span></span></span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-family: inherit;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-family: inherit;">Also, by using <b>wsdl2jolie</b> first and then tools such as <b>jolie2plasma</b> one could use the Jolie intermediate representation for transforming a Web Service interface definition into a (<a href="http://www.kde.org/">KDE</a>) Plasma::Service XML one. With the same trick, one could also write C++ generators for QtJolie and introduce ease and type-safeness to Web Services invocations. I and KÃ©vin sure have things to think about now. ;-)</span></span></span></span></span></span><br /><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-family: inherit;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-family: inherit;">Beware that the code is still in its early stages. It already works with a lot of Web Services, but we're still improving it. For instance, we currently support only the SOAP document format (which is the one people advise to use, anyway). Patches, comments and reports are welcome in jolie-devel @ lists.sourceforge.net!</span></span></span></span></span></span>